<!DOCTYPE html>
<html>
<head>
    <title>Start Chat on Button Click</title>
</head>
<body>
    <button id="start-chat-button" disabled>Start Chat</button> <!-- Disable button initially -->

    <script type='text/javascript'>
        let embeddedSvcLoaded = false;

        // Callback function after the script is loaded
        function onEmbeddedSvcLoaded() {
            embeddedSvcLoaded = true;
            initESW('https://orgfarm-5b184b8ce8-dev-ed.develop.my.site.com');
            document.getElementById("start-chat-button").disabled = false; // Enable button after initialization
        }

        // Initialize Embedded Service
        var initESW = function(gslbBaseURL) {
            embedded_svc.settings.displayHelpButton = false; // Hide the default help button
            embedded_svc.settings.language = 'en_US'; // For example, enter 'en' or 'en-US'
            embedded_svc.init(
                '00DdL00000N7Glz',
                'ESA_Web_Deployment',
                gslbBaseURL,
                'https://orgfarm-5b184b8ce8-dev-ed.develop.my.salesforce-scrt.com'
            );
        };

        // Start Chat Function
        function startChat() {
            if (!embeddedSvcLoaded) {
                console.error('Embedded Service is not yet loaded.');
                return;
            }
            console.log('Inside Start Chat');
            embedded_svc.liveAgentAPI.startChat({
                directToAgentRouting: {
                    buttonId: "5735f000000Tm6g",
                    fallback: true
                },
                extraPrechatInfo: [],
                extraPrechatFormDetails: []
            });
        }

        // Add click event listener after the script is loaded
        document.getElementById("start-chat-button").addEventListener("click", startChat);
    </script>

    <!-- Load the Embedded Service script and call the callback function -->
    <script type='text/javascript' src='https://orgfarm-5b184b8ce8-dev-ed.develop.my.site.com/ESWESAWebDeployment1724800920657/assets/js/bootstrap.min.js' onload='onEmbeddedSvcLoaded()'></script>
</body>
</html>
